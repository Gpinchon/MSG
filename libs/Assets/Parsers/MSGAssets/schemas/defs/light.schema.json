{
  "$schema": "https://json-schema.org/draft/2020-12/schema#",
  "$id": "light.schema.json",
  "title": "MSGAssets-light",
  "type": "object",
  "definitions": {
    "shadowSettings": {
      "title": "ShadowSettings",
      "type": "object",
      "properties": {
        "castShadow": {
          "type": "boolean",
          "description": "if true this light will cast a dynamic shadow",
          "default": false
        },
        "shadowPrecision": {
          "type": "string",
          "description": "allows the renderer to lower shadow buffer precision to save space and performance",
          "enum": [
            "High",
            "Medium",
            "Low"
          ],
          "default": "High"
        },
        "bias": {
          "type": "number",
          "description": "the base amount of bias to apply to shadow maps",
          "default": 0.0025
        },
        "normalBias": {
          "type": "number",
          "minimum": 0,
          "description": "the amount of extra bias to be applied to 90 degrees normals in texels",
          "default": 0.1
        },
        "blurRadius": {
          "type": "number",
          "minimum": 0,
          "description": "blur radius in texels",
          "default": 1
        },
        "resolution": {
          "type": "number",
          "minimum": 128,
          "description": "the shadow map resolution",
          "default": 512
        },
        "cascadeCount": {
          "type": "number",
          "description": "1 means no cascades",
          "default": 1
        }
      }
    },
    "lightType": {
      "enum": [
        "Point",
        "Spot",
        "Directional",
        "IBL"
      ],
      "type": "string",
      "description": "the type of light, must be: point, spot, directional or IBL"
    },
    "lightPointData": {
      "title": "PointLightData",
      "properties": {
        "range": {
          "type": "number",
          "minimum": 0,
          "description": "the range of this light in meters",
          "default": "Infinity"
        }
      }
    },
    "lightSpotData": {
      "title": "SpotLightData",
      "properties": {
        "range": {
          "type": "number",
          "minimum": 0,
          "description": "the range of this light in meters",
          "default": "Infinity"
        },
        "innerConeAngle": {
          "type": "number",
          "minimum": 0,
          "description": "mandatory if type is Spot; the angle at which the spot light attenuation starts in radians",
          "default": 0
        },
        "outerConeAngle": {
          "type": "number",
          "minimum": 0,
          "description": "mandatory if type is Spot; the spot light angle in radians, default is pi/4",
          "default": 0.785398
        }
      }
    },
    "lightDirData": {
      "title": "DirectionalLightData",
      "halfSize": {
        "description": "mandatory if type is Directional or IBL; the size of the light's AABB",
        "$ref": "vec.schema.json#definitions/vec3"
      }
    },
    "IBLData": {
      "title": "ImageBasedLightData",
      "properties": {
        "halfSize": {
          "description": "mandatory if type is Directional or IBL; the size of the light's AABB",
          "$ref": "vec.schema.json#definitions/vec3"
        },
        "boxProjection": {
          "type": "boolean",
          "description": "if set to true, the light sampling will be offset using box projection",
          "default": true
        },
        "specular": {
          "type": "number",
          "description": "an index into the textures array to use for specular/reflection, if the texture is 2D, a cubemap will be generated",
          "minimum": 0
        },
        "specularSampler": {
          "type": "number",
          "description": "an index into the samplers array to use for specular/reflection",
          "minimum": 0,
          "required": true
        },
        "irradianceCoefficients": {
          "type": "array",
          "description": "the irradiance coefficients generated using spherical harmonics to get the IBL diffuse color, if absent, generated on the fly using specular texture",
          "items": {
            "$ref": "vec.schema.json#definitions/vec3"
          },
          "minItems": 16,
          "maxItems": 16
        }
      }
    },
    "lightData": {
      "title": "LightData",
      "type": "object",
      "oneOf": [
        {
          "$ref": "light.schema.json#/definitions/lightPointData"
        },
        {
          "$ref": "light.schema.json#/definitions/lightSpotData"
        },
        {
          "$ref": "light.schema.json#/definitions/lightDirData"
        },
        {
          "$ref": "light.schema.json#/definitions/IBLData"
        }
      ]
    },
    "punctualLight": {
      "title": "PunctualLight",
      "type": "object",
      "description": "describes a punctual light, the type of the data property is defined by the value of the type property",
      "properties": {
        "copyFrom": {
          "$ref": "external.schema.json#/definitions/fromEntity"
        },
        "type": {
          "$ref": "light.schema.json#/definitions/lightType"
        },
        "color": {
          "description": "the color of the light in RGB format",
          "$ref": "vec.schema.json#/definitions/vec3",
          "default": [
            1,
            1,
            1
          ]
        },
        "intensity": {
          "type": "number",
          "minimum": 0,
          "description": "the intensity of the light in lm/sr for spot and directional, lm/mÂ² for directional, and a unitless muliplier for IBL",
          "default": 1
        },
        "falloff": {
          "type": "number",
          "minimum": 0,
          "description": "used to compute inverse square root for attenuation",
          "default": 2
        },
        "lightShaftIntensity": {
          "type": "number",
          "minimum": 0,
          "description": "defines how visible this light will be when volumetric fog is enabled",
          "default": 1
        },
        "priority": {
          "type": "number",
          "description": "lights with higher priorities will be displayed in priority",
          "default": 0
        },
        "shadowSettings": {
          "$ref": "light.schema.json#/definitions/shadowSettings"
        },
        "data": {
          "$ref": "light.schema.json#/definitions/lightData"
        }
      },
      "if": {
        "not": {
          "required": [
            "copyFrom"
          ]
        }
      },
      "then": {
        "required": [
          "type",
          "data"
        ]
      }
    }
  }
}